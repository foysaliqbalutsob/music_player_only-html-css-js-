<!DOCTYPE html>
<html id="html-root" class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Neon Music Pro - Local Browse</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@300;400;600;700&display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: { "primary": "#1313ec", "background-dark": "#101022", "background-light": "#f8fafc" },
                    fontFamily: { "display": ["Spline Sans", "sans-serif"] },
                },
            },
        }
    </script>
    <style>
        .ios-blur { backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); }
        .neon-glow { box-shadow: 0 0 20px rgba(19, 19, 236, 0.4); }
        .hidden-tab { display: none !important; }
        .rotating { animation: rotate 20s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #1313ec; border-radius: 10px; }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white font-display overflow-hidden transition-colors duration-300">

<audio id="main-audio"></audio>

<div id="add-song-modal" class="hidden-tab fixed inset-0 z-[100] flex items-center justify-center p-6 bg-black/60 ios-blur">
    <div class="bg-white dark:bg-[#1a1a3a] w-full max-w-sm rounded-3xl p-6 border border-slate-200 dark:border-white/10 shadow-2xl">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold">New Track</h3>
            <button onclick="closeModal()" class="text-slate-400 hover:text-red-500 transition-colors"><span class="material-symbols-outlined">close</span></button>
        </div>
        
        <div class="space-y-4">
            <div class="p-4 border-2 border-dashed border-primary/30 rounded-2xl bg-primary/5 text-center">
                <label for="local-file" class="cursor-pointer">
                    <span class="material-symbols-outlined text-4xl text-primary">cloud_upload</span>
                    <p class="text-xs mt-2 font-bold text-primary uppercase">Browse Audio File</p>
                    <input type="file" id="local-file" accept="audio/*" class="hidden" onchange="handleFileSelect(event)">
                </label>
                <p id="file-name-display" class="text-[10px] mt-2 text-slate-400 truncate hidden"></p>
            </div>

            <div class="space-y-2">
                <input type="text" id="new-title" placeholder="Song Title" class="w-full bg-slate-100 dark:bg-white/5 rounded-xl px-4 py-2.5 outline-none border border-transparent focus:border-primary transition-all">
                <input type="text" id="new-artist" placeholder="Artist Name" class="w-full bg-slate-100 dark:bg-white/5 rounded-xl px-4 py-2.5 outline-none border border-transparent focus:border-primary transition-all">
                <input type="text" id="new-img" placeholder="Album Image URL" class="w-full bg-slate-100 dark:bg-white/5 rounded-xl px-4 py-2.5 outline-none border border-transparent focus:border-primary transition-all">
                <input type="text" id="new-path" placeholder="OR Paste MP3 URL" class="w-full bg-slate-100 dark:bg-white/5 rounded-xl px-4 py-2.5 outline-none border border-transparent focus:border-primary transition-all">
            </div>
        </div>
        
        <button onclick="addNewSong()" class="w-full mt-6 py-3 rounded-xl bg-primary text-white font-bold shadow-lg shadow-primary/30 active:scale-95 transition-transform">Add to Library</button>
    </div>
</div>

<div class="flex h-screen w-full max-w-[430px] mx-auto flex-col overflow-hidden shadow-2xl border-x border-slate-200 dark:border-slate-800 relative bg-white dark:bg-background-dark">

    <div id="player-screen" class="hidden-tab absolute inset-0 z-50 flex flex-col bg-white dark:bg-background-dark transition-all duration-300">
        <div class="flex items-center p-6 justify-between">
            <div onclick="hidePlayer()" class="flex size-10 items-center justify-center cursor-pointer hover:bg-slate-100 dark:hover:bg-white/10 rounded-full">
                <span class="material-symbols-outlined text-2xl">expand_more</span>
            </div>
            <h2 class="text-[10px] uppercase tracking-widest font-black text-slate-400">Now Playing</h2>
            <div class="size-10"></div>
        </div>
        <div class="flex-1 flex flex-col items-center justify-center px-8 gap-10">
            <div id="album-ring" class="relative">
                <div class="absolute inset-0 rounded-full bg-primary/20 blur-3xl"></div>
                <div class="relative size-64 rounded-full border-4 border-slate-200 dark:border-white/10 p-2 neon-glow overflow-hidden transition-all duration-500">
                    <div id="player-art" class="w-full h-full rounded-full bg-center bg-cover bg-slate-200 dark:bg-slate-800 transition-all duration-700"></div>
                </div>
            </div>
            <div class="text-center">
                <h1 id="player-title" class="text-2xl font-bold">Select a song</h1>
                <p id="player-artist" class="text-primary text-lg font-medium">Neon Music</p>
            </div>
        </div>
        <div class="px-6 pb-12 space-y-6">
            <input type="range" id="progress-slider" value="0" class="w-full h-1.5 bg-slate-200 dark:bg-white/10 accent-primary rounded-full appearance-none cursor-pointer">
            <div class="flex justify-between px-2 items-center">
                <button onclick="prevTrack()" class="active:scale-90 transition-transform"><span class="material-symbols-outlined text-5xl">skip_previous</span></button>
                <button onclick="togglePlay()" class="size-20 flex items-center justify-center rounded-full bg-primary text-white shadow-xl shadow-primary/40 active:scale-95 transition-transform">
                    <span id="master-play-icon" class="material-symbols-outlined text-5xl">play_arrow</span>
                </button>
                <button onclick="nextTrack()" class="active:scale-90 transition-transform"><span class="material-symbols-outlined text-5xl">skip_next</span></button>
            </div>
            <div class="flex items-center gap-3 bg-slate-100 dark:bg-white/5 p-3 rounded-2xl">
                <span class="material-symbols-outlined text-slate-400">volume_down</span>
                <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.7" class="flex-1 h-1 accent-primary appearance-none bg-slate-300 dark:bg-white/20 rounded-full">
                <span class="material-symbols-outlined text-slate-400">volume_up</span>
            </div>
        </div>
    </div>

    <header class="p-4 flex justify-between items-center bg-white/80 dark:bg-background-dark/80 ios-blur sticky top-0 z-30">
        <span class="material-symbols-outlined">notes</span>
        <h2 id="tab-title" class="font-bold text-lg">Home</h2>
        <button onclick="openModal()" class="text-primary hover:scale-110 active:scale-90 transition-transform"><span class="material-symbols-outlined text-3xl">add_circle</span></button>
    </header>

    <main class="flex-1 overflow-y-auto pb-44">
        <div id="home-tab" class="p-6 space-y-8">
            <div class="relative w-full h-44 rounded-3xl overflow-hidden shadow-lg group">
                <img src="https://images.unsplash.com/photo-1493225255756-d9584f8606e9?w=800" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent p-6 flex flex-col justify-end">
                    <h3 class="text-white text-2xl font-bold">Premium Vibes</h3>
                    <p class="text-white/70 text-sm">Experience local & cloud music</p>
                </div>
            </div>

            <div>
                <h4 class="font-bold mb-4">Quick Play</h4>
                <div class="grid grid-cols-2 gap-4">
                    <div onclick="playSong(0)" class="bg-blue-600/10 p-4 rounded-3xl border border-blue-500/10 cursor-pointer hover:bg-blue-600/20 transition-all">
                        <div class="size-10 rounded-full bg-blue-500 flex items-center justify-center text-white mb-3 shadow-lg shadow-blue-500/40"><span class="material-symbols-outlined">bolt</span></div>
                        <p class="font-bold text-sm">Neon Drift</p>
                        <p class="text-[10px] opacity-50 uppercase tracking-tighter">Retro Synth</p>
                    </div>
                    <div onclick="playSong(1)" class="bg-purple-600/10 p-4 rounded-3xl border border-purple-500/10 cursor-pointer hover:bg-purple-600/20 transition-all">
                        <div class="size-10 rounded-full bg-purple-500 flex items-center justify-center text-white mb-3 shadow-lg shadow-purple-500/40"><span class="material-symbols-outlined">Waves</span></div>
                        <p class="font-bold text-sm">Cyber Wave</p>
                        <p class="text-[10px] opacity-50 uppercase tracking-tighter">Electro</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="library-tab" class="hidden-tab">
            <div class="px-6 py-4 flex justify-between items-center bg-slate-50/50 dark:bg-white/5 border-b border-slate-100 dark:border-white/5">
                <p id="track-count" class="text-[10px] text-slate-500 font-black uppercase tracking-[0.2em]">0 Songs</p>
                <span class="material-symbols-outlined text-slate-400">sort</span>
            </div>
            <div id="track-list-container" class="flex flex-col"></div>
        </div>

        <div id="settings-tab" class="hidden-tab p-6 space-y-4">
            <div class="flex items-center justify-between bg-slate-100 dark:bg-white/5 p-4 rounded-2xl">
                <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-primary">dark_mode</span>
                    <span class="font-bold text-sm">Dark Mode</span>
                </div>
                <button onclick="toggleDarkMode()" class="w-12 h-6 bg-primary rounded-full relative transition-all">
                    <div id="dark-mode-dot" class="absolute top-1 left-1 size-4 bg-white rounded-full transition-all translate-x-6"></div>
                </button>
            </div>
            <button onclick="resetApp()" class="w-full flex items-center gap-3 bg-red-500/10 text-red-500 p-4 rounded-2xl hover:bg-red-500/20 transition-all">
                <span class="material-symbols-outlined">delete_forever</span>
                <span class="font-bold text-sm uppercase tracking-wider">Clear Library</span>
            </button>
        </div>
    </main>

    <footer class="absolute bottom-0 w-full bg-white/95 dark:bg-background-dark/95 ios-blur border-t border-slate-200 dark:border-white/5 pt-0 pb-6 z-40">
        <div class="w-full h-[2px] bg-slate-200 dark:bg-white/10 mb-2">
            <div id="mini-progress-bar" class="h-full bg-primary shadow-[0_0_8px_rgba(19,19,236,0.6)] w-0 transition-all duration-300"></div>
        </div>

        <div onclick="showPlayer()" class="px-4 mb-4 flex items-center justify-between cursor-pointer group">
            <div class="flex items-center gap-3">
                <div id="mini-art" class="size-12 rounded-full bg-cover bg-center border border-primary/20 bg-slate-200 dark:bg-slate-800"></div>
                <div>
                    <p id="mini-title" class="text-sm font-bold truncate w-32">Select a track</p>
                    <p id="mini-artist" class="text-primary text-[10px] font-black uppercase">NEON MUSIC</p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <button onclick="event.stopPropagation(); togglePlay();" class="size-10 flex items-center justify-center rounded-full bg-primary text-white shadow-lg active:scale-90 transition-transform">
                    <span id="mini-play-icon" class="material-symbols-outlined">play_arrow</span>
                </button>
                <button onclick="event.stopPropagation(); nextTrack();" class="text-slate-400"><span class="material-symbols-outlined">skip_next</span></button>
            </div>
        </div>

        <div class="flex justify-around items-center pt-2">
            <button onclick="switchTab('home')" id="nav-home" class="flex flex-col items-center gap-1 text-primary">
                <span class="material-symbols-outlined">home</span><span class="text-[10px] font-bold">Home</span>
            </button>
            <button onclick="switchTab('library')" id="nav-library" class="flex flex-col items-center gap-1 text-slate-400">
                <span class="material-symbols-outlined">library_music</span><span class="text-[10px] font-bold">Library</span>
            </button>
            <button onclick="switchTab('settings')" id="nav-settings" class="flex flex-col items-center gap-1 text-slate-400">
                <span class="material-symbols-outlined">settings</span><span class="text-[10px] font-bold">Settings</span>
            </button>
        </div>
    </footer>
</div>

<script>
    const DEFAULT_IMG = "https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=500";
    
    // 5 DUMMY SONGS
    const dummySongs = [
        { title: "Midnight City", artist: "M83", path: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3", img: "https://images.unsplash.com/photo-1614613535308-eb5fbd3d2c17?w=500" },
        { title: "Nightcall", artist: "Kavinsky", path: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3", img: "https://images.unsplash.com/photo-1557672172-298e090bd0f1?w=500" },
        { title: "Starboy", artist: "The Weeknd", path: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3", img: "https://images.unsplash.com/photo-1619983081563-430f63602796?w=500" },
        { title: "Blinding Lights", artist: "Weeknd", path: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3", img: "https://images.unsplash.com/photo-1493225255756-d9584f8606e9?w=500" },
        { title: "Synthwave Dreams", artist: "Retro", path: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3", img: "https://images.unsplash.com/photo-1550684848-fac1c5b4e853?w=500" }
    ];

    let playlist = JSON.parse(localStorage.getItem('NEON_MUSIC_DATA')) || dummySongs;
    let currentTrackIndex = 0;
    let isPlaying = false;
    let localAudioPath = "";
    const audio = document.getElementById('main-audio');

    // TABS
    function switchTab(tabId) {
        document.querySelectorAll('main > div').forEach(tab => tab.classList.add('hidden-tab'));
        document.querySelectorAll('footer button').forEach(btn => btn.classList.replace('text-primary', 'text-slate-400'));
        
        document.getElementById(tabId + '-tab').classList.remove('hidden-tab');
        document.getElementById('nav-' + tabId).classList.replace('text-slate-400', 'text-primary');
        document.getElementById('tab-title').innerText = tabId.charAt(0).toUpperCase() + tabId.slice(1);
    }

    // LOCAL FILE SELECTION
    function handleFileSelect(event) {
        const file = event.target.files[0];
        if (file) {
            localAudioPath = URL.createObjectURL(file);
            const fileName = document.getElementById('file-name-display');
            fileName.innerText = "Selected: " + file.name;
            fileName.classList.remove('hidden');
            document.getElementById('new-title').value = file.name.replace(/\.[^/.]+$/, "");
            document.getElementById('new-artist').value = "Local Audio";
        }
    }

    function addNewSong() {
        const title = document.getElementById('new-title').value;
        const artist = document.getElementById('new-artist').value;
        const img = document.getElementById('new-img').value || DEFAULT_IMG;
        const path = localAudioPath || document.getElementById('new-path').value;
        
        if(title && path) {
            playlist.push({ title, artist: artist || 'Unknown Artist', path, img });
            localStorage.setItem('NEON_MUSIC_DATA', JSON.stringify(playlist));
            renderLibrary();
            closeModal();
            // Reset
            ['new-title', 'new-artist', 'new-img', 'new-path'].forEach(id => document.getElementById(id).value = '');
            document.getElementById('file-name-display').classList.add('hidden');
            localAudioPath = "";
        } else { alert("Please select a file or enter a URL"); }
    }

    function renderLibrary() {
        const container = document.getElementById('track-list-container');
        document.getElementById('track-count').innerText = `${playlist.length} Songs`;
        container.innerHTML = playlist.map((song, i) => `
            <div onclick="playSong(${i})" class="flex items-center gap-4 p-4 hover:bg-slate-100 dark:hover:bg-white/5 cursor-pointer border-b border-slate-50 dark:border-white/5 transition-all">
                <div class="size-12 rounded-xl bg-slate-200 dark:bg-slate-800 shrink-0 bg-cover bg-center shadow-md" style="background-image:url('${song.img}')"></div>
                <div class="flex-1 overflow-hidden">
                    <p class="font-bold truncate ${currentTrackIndex === i ? 'text-primary' : ''}">${song.title}</p>
                    <p class="text-[10px] text-slate-500 font-bold uppercase tracking-wider">${song.artist}</p>
                </div>
                <span class="material-symbols-outlined ${currentTrackIndex === i && isPlaying ? 'text-primary' : 'text-slate-300'}">
                    ${currentTrackIndex === i && isPlaying ? 'equalizer' : 'play_circle'}
                </span>
            </div>
        `).join('');
    }

    function playSong(index) {
        if(!playlist[index]) return;
        currentTrackIndex = index;
        const song = playlist[index];
        audio.src = song.path;
        
        // Update UI
        document.getElementById('player-title').innerText = song.title;
        document.getElementById('player-artist').innerText = song.artist;
        document.getElementById('player-art').style.backgroundImage = `url('${song.img}')`;
        document.getElementById('mini-title').innerText = song.title;
        document.getElementById('mini-artist').innerText = song.artist;
        document.getElementById('mini-art').style.backgroundImage = `url('${song.img}')`;
        
        togglePlay(true);
        renderLibrary();
    }

    function togglePlay(forcePlay = false) {
        const mIcon = document.getElementById('master-play-icon');
        const miniIcon = document.getElementById('mini-play-icon');
        const ring = document.getElementById('album-ring');

        if (forcePlay || audio.paused) {
            audio.play().catch(e => console.log("Error playing"));
            isPlaying = true;
            mIcon.innerText = 'pause'; miniIcon.innerText = 'pause';
            ring.classList.add('rotating');
        } else {
            audio.pause();
            isPlaying = false;
            mIcon.innerText = 'play_arrow'; miniIcon.innerText = 'play_arrow';
            ring.classList.remove('rotating');
        }
        renderLibrary();
    }

    function nextTrack() { if(playlist.length > 0) playSong((currentTrackIndex + 1) % playlist.length); }
    function prevTrack() { if(playlist.length > 0) playSong((currentTrackIndex - 1 + playlist.length) % playlist.length); }

    audio.ontimeupdate = () => {
        const p = (audio.currentTime / audio.duration) * 100 || 0;
        document.getElementById('progress-slider').value = p;
        document.getElementById('mini-progress-bar').style.width = p + '%';
    };

    audio.onended = nextTrack;
    document.getElementById('volume-slider').oninput = (e) => audio.volume = e.target.value;
    document.getElementById('progress-slider').oninput = (e) => audio.currentTime = (e.target.value / 100) * audio.duration;

    function toggleDarkMode() {
        document.getElementById('html-root').classList.toggle('dark');
        const isDark = document.getElementById('html-root').classList.contains('dark');
        document.getElementById('dark-mode-dot').style.transform = isDark ? 'translateX(1.5rem)' : 'translateX(0)';
    }

    function resetApp() { if(confirm("Clear library?")) { localStorage.clear(); location.reload(); } }
    function openModal() { document.getElementById('add-song-modal').classList.remove('hidden-tab'); }
    function closeModal() { document.getElementById('add-song-modal').classList.add('hidden-tab'); }
    function showPlayer() { document.getElementById('player-screen').classList.remove('hidden-tab'); }
    function hidePlayer() { document.getElementById('player-screen').classList.add('hidden-tab'); }

    // Init
    renderLibrary();
    if(playlist.length > 0) {
        const s = playlist[0];
        document.getElementById('player-art').style.backgroundImage = `url('${s.img}')`;
        document.getElementById('mini-art').style.backgroundImage = `url('${s.img}')`;
    }
</script>
</body>
</html>